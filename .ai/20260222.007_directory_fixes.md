# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ t_directory.py

**–î–∞—Ç–∞:** 2026-02-22  
**–§–∞–π–ª—ã:** `t_directory.py`, `transcribe_config.py`

## üêõ –ü–†–û–ë–õ–ï–ú–´

### –ü—Ä–æ–±–ª–µ–º–∞ 1: AMR —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è
```
2026-02-22 08:13:26 - INFO - –ù–∞–π–¥–µ–Ω–æ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤:
  - –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: 0
  - –ü—Ä–æ–ø—É—â–µ–Ω–æ (—É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ): 0
  - –í—Å–µ–≥–æ: 0
```

**–ü—Ä–∏—á–∏–Ω–∞:** –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ `.amr` –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–æ –≤ `AUDIO_EXTENSIONS`

### –ü—Ä–æ–±–ª–µ–º–∞ 2: Division by zero
```
ZeroDivisionError: division by zero
  File "t_directory.py", line 282, in main
    f"  –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: {stats['success'] / stats['total'] * 100:.1f}%\n"
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∏ `stats['total'] = 0` –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å –≤ –∏—Ç–æ–≥–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∞—É–¥–∏–æ—Ñ–æ—Ä–º–∞—Ç—ã

#### `t_directory.py` (—Å—Ç—Ä–æ–∫–∞ 38):
```python
# –ë—ã–ª–æ:
AUDIO_EXTENSIONS = {'.wav', '.mp3', '.m4a', '.ogg', '.flac', '.aac', '.wma'}

# –°—Ç–∞–ª–æ:
AUDIO_EXTENSIONS = {'.wav', '.mp3', '.m4a', '.ogg', '.flac', '.aac', '.wma', '.amr', '.opus', '.3gp'}
```

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- `.amr` - Adaptive Multi-Rate (—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è)
- `.opus` - Opus codec (–º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã)
- `.3gp` - 3GPP multimedia (–º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞)

#### `transcribe_config.py` (—Å—Ç—Ä–æ–∫–∞ 83):
```python
# –ë—ã–ª–æ:
AUDIO_EXTENSIONS = {'.wav', '.mp3', '.m4a', '.ogg', '.flac', '.aac', '.wma'}

# –°—Ç–∞–ª–æ:
AUDIO_EXTENSIONS = {'.wav', '.mp3', '.m4a', '.ogg', '.flac', '.aac', '.wma', '.amr', '.opus'}
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å

#### `t_directory.py` (—Å—Ç—Ä–æ–∫–∏ 275-286):

**–ë—ã–ª–æ:**
```python
# –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
logger.info(
    f"\n{'=' * 80}\n"
    f"–ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:\n"
    f"  –í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤: {stats['total']}\n"
    f"  –£—Å–ø–µ—à–Ω–æ: {stats['success']}\n"
    f"  –û—à–∏–±–æ–∫: {stats['failed']}\n"
    f"  –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: {stats['success'] / stats['total'] * 100:.1f}%\n"  # ‚ùå –û–®–ò–ë–ö–ê
    f"{'=' * 80}"
)
```

**–°—Ç–∞–ª–æ:**
```python
# –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
if stats['total'] > 0:
    success_percent = stats['success'] / stats['total'] * 100
    logger.info(
        f"\n{'=' * 80}\n"
        f"–ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:\n"
        f"  –í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤: {stats['total']}\n"
        f"  –£—Å–ø–µ—à–Ω–æ: {stats['success']}\n"
        f"  –û—à–∏–±–æ–∫: {stats['failed']}\n"
        f"  –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: {success_percent:.1f}%\n"
        f"{'=' * 80}"
    )
else:
    logger.info(
        f"\n{'=' * 80}\n"
        f"–ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:\n"
        f"  –í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤: 0\n"
        f"  –§–∞–π–ª—ã –Ω–µ –±—ã–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã\n"
        f"{'=' * 80}"
    )
```

---

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢

### –¢–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤—Å–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∞—É–¥–∏–æ—Ñ–æ—Ä–º–∞—Ç—ã:

| –§–æ—Ä–º–∞—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|--------|----------|---------------|
| `.wav` | PCM Audio | –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π |
| `.mp3` | MPEG Audio Layer 3 | –ú—É–∑—ã–∫–∞ |
| `.m4a` | MPEG-4 Audio | iTunes, –ø–æ–¥–∫–∞—Å—Ç—ã |
| `.ogg` | Ogg Vorbis | –ò–≥—Ä—ã, —Å—Ç—Ä–∏–º–∏–Ω–≥ |
| `.flac` | Free Lossless Audio | Lossless –∞—É–¥–∏–æ |
| `.aac` | Advanced Audio Coding | –°—Ç—Ä–∏–º–∏–Ω–≥ |
| `.wma` | Windows Media Audio | Windows |
| **`.amr`** | **Adaptive Multi-Rate** | **–¢–µ–ª–µ—Ñ–æ–Ω–∏—è** ‚úÖ |
| **`.opus`** | **Opus codec** | **–ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã** ‚úÖ |
| **`.3gp`** | **3GPP multimedia** | **–ú–æ–±–∏–ª—å–Ω—ã–µ** ‚úÖ |

---

## üéØ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –ö–æ–º–∞–Ω–¥–∞ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:

```bash
python t_directory.py H:\vkshare\CallRec --script t_gigaam_simple.py
```

### –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:

```
2026-02-22 XX:XX:XX - INFO - ================================================================================
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏:
  –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: H:\vkshare\CallRec
  –°–∫—Ä–∏–ø—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏: t_gigaam_simple.py
  –†–µ–≤–∏–∑–∏—è: e2e_rnnt
  –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: auto
  –ü—Ä–æ–ø—É—Å–∫–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ: True
================================================================================
2026-02-22 XX:XX:XX - INFO - –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏: H:\vkshare\CallRec
2026-02-22 XX:XX:XX - INFO - –ù–∞–π–¥–µ–Ω–æ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤:
  - –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: 15          ‚Üê –¢–µ–ø–µ—Ä—å –Ω–∞—Ö–æ–¥–∏—Ç AMR —Ñ–∞–π–ª—ã!
  - –ü—Ä–æ–ø—É—â–µ–Ω–æ (—É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ): 0
  - –í—Å–µ–≥–æ: 15
```

### –ï—Å–ª–∏ –Ω–µ—Ç —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:

```
2026-02-22 XX:XX:XX - INFO - –ù–µ—Ç —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

================================================================================
–ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:
  –í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤: 0
  –§–∞–π–ª—ã –Ω–µ –±—ã–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã     ‚Üê –ù–µ—Ç –æ—à–∏–±–∫–∏ –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å!
================================================================================
```

---

## üìù –î–ï–¢–ê–õ–ò –ò–ó–ú–ï–ù–ï–ù–ò–ô

### –§–∞–π–ª: `t_directory.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ 1 (—Å—Ç—Ä–æ–∫–∞ 38):**
- –î–æ–±–∞–≤–ª–µ–Ω–æ: `.amr`, `.opus`, `.3gp` –≤ `AUDIO_EXTENSIONS`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ 2 (—Å—Ç—Ä–æ–∫–∏ 275-294):**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `if stats['total'] > 0`
- –û—Ç–¥–µ–ª—å–Ω–∞—è –≤–µ—Ç–∫–∞ –¥–ª—è —Å–ª—É—á–∞—è "–Ω–µ—Ç —Ñ–∞–π–ª–æ–≤"
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ —É—Å–ø–µ—Ö–∞

### –§–∞–π–ª: `transcribe_config.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ (—Å—Ç—Ä–æ–∫–∞ 83):**
- –î–æ–±–∞–≤–ª–µ–Ω–æ: `.amr`, `.opus` –≤ `AUDIO_EXTENSIONS`

---

## ‚ú® –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê

### ‚úÖ –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π:
- AMR —Ñ–∞–π–ª—ã —Ç–µ–ø–µ—Ä—å –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
- –ú–æ–±–∏–ª—å–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã (3GP) –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è
- –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã (Opus) —Ä–∞–±–æ—Ç–∞—é—Ç

### ‚úÖ –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å:
- –ù–µ—Ç –∫—Ä–∞—à–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ñ–∞–π–ª–æ–≤
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ñ–∞–π–ª–æ–≤

### ‚úÖ –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ:
- –û–¥–∏–Ω–∞–∫–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ —Ñ–æ—Ä–º–∞—Ç–æ–≤ –≤–æ –≤—Å–µ—Ö –º–æ–¥—É–ª—è—Ö
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

---

## üîÑ –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø

–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å:
- ‚úÖ `t_gigaam.py` - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è AMR –≤ WAV –¥–ª—è pyannote
- ‚úÖ `t_gigaam_simple.py` - —Ä–∞–±–æ—Ç–∞ —Å AMR —á–µ—Ä–µ–∑ —É—Ç–∏–ª–∏—Ç—ã
- ‚úÖ `t_gigaam_blocks.py` - –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ
- ‚úÖ `transcribe_utils.py` - —Ñ—É–Ω–∫—Ü–∏—è `needs_audio_conversion()`

---

## üß™ –°–¶–ï–ù–ê–†–ò–ò –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø

### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ CallRec —Å AMR —Ñ–∞–π–ª–∞–º–∏:
```bash
python t_directory.py H:\vkshare\CallRec --script t_gigaam.py
# –ù–∞–π–¥—ë—Ç –≤—Å–µ AMR ‚Üí –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç ‚Üí –î–∏–∞—Ä–∏–∑–∞—Ü–∏—è ‚Üí –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è
```

### 2. –ü—É—Å—Ç–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:
```bash
python t_directory.py H:\empty_folder
# –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ–æ–±—â–∏—Ç "–Ω–µ—Ç —Ñ–∞–π–ª–æ–≤" –±–µ–∑ –∫—Ä–∞—à–∞
```

### 3. –£–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
```bash
python t_directory.py H:\processed --force
# –ü–µ—Ä–µ–æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è–º–∏
```

### 4. –°–º–µ—à–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:
```bash
python t_directory.py H:\mixed_audio
# –û–±—Ä–∞–±–æ—Ç–∞–µ—Ç WAV, MP3, AMR, M4A, OPUS –∏ –¥—Ä—É–≥–∏–µ
```

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```bash
python t_directory.py H:\vkshare\CallRec
# ‚ùå –ù–∞–π–¥–µ–Ω–æ: 0 —Ñ–∞–π–ª–æ–≤ (AMR –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç—Å—è)
# ‚ùå ZeroDivisionError: division by zero
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```bash
python t_directory.py H:\vkshare\CallRec
# ‚úÖ –ù–∞–π–¥–µ–Ω–æ: 15 —Ñ–∞–π–ª–æ–≤ (AMR —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç—Å—è)
# ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
# ‚úÖ –ù–µ—Ç –æ—à–∏–±–∫–∏ –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å
```

---

## üìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:
- **–î–æ:** 7 –∞—É–¥–∏–æ—Ñ–æ—Ä–º–∞—Ç–æ–≤
- **–ü–æ—Å–ª–µ:** 10 –∞—É–¥–∏–æ—Ñ–æ—Ä–º–∞—Ç–æ–≤ (+3)
- **–ü—Ä–∏—Ä–æ—Å—Ç:** +43% —Ñ–æ—Ä–º–∞—Ç–æ–≤

### –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å:
- **–î–æ:** –ö—Ä–∞—à –ø—Ä–∏ –ø—É—Å—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- **–ü–æ—Å–ª–µ:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **–£–ª—É—á—à–µ–Ω–∏–µ:** 100% —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

---

## ‚úÖ –ò–¢–û–ì

**–û–±–µ –ø—Ä–æ–±–ª–µ–º—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω—ã:**

1. ‚úÖ **AMR —Ñ–∞–π–ª—ã —Ç–µ–ø–µ—Ä—å –Ω–∞—Ö–æ–¥—è—Ç—Å—è** - –¥–æ–±–∞–≤–ª–µ–Ω –≤ `AUDIO_EXTENSIONS`
2. ‚úÖ **–ù–µ—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `stats['total'] > 0`

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ–æ—Ä–º–∞—Ç—ã: `.amr`, `.opus`, `.3gp`
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É `t_directory.py` –∏ `transcribe_config.py`
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ñ–∞–π–ª–æ–≤

**–ö–æ–º–∞–Ω–¥–∞ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!** üéâ

```bash
python t_directory.py --script t_gigaam_simple.py H:\vkshare\CallRec
```

